{% extends "layout/posts.html" %}

{% block title %}新建博客{% endblock %}

{% block body %}
<div class="container">
  <div id="primary">
    <div id="content" role="main">
      <form method="post" action="/posts/create" enctype="multipart/form-data">
        <input id="fileupload" type="file" name="file" value="请上传图片" />
        <input type="hidden" name="image" value="" />

        <input type="text" name="title" value="">
        <textarea name="summary"></textarea>
        <textarea name="content"></textarea>
        <textarea name="markdown"></textarea>
        <input type="number" name="author_id" value="">

        <input type="submit" value="submit" class="submit-post" />
      </form>

      <!-- ace editor -->
      <div id="editor">## Readme</div>
      <script src="/static/plugins/ace1.2.0/ace.js" type="text/javascript" charset="utf-8"></script>
      <script>
        // http://ace.c9.io/#nav=howto
        var editor = ace.edit("editor");
        editor.setTheme("ace/theme/monokai");
        editor.getSession().setMode("ace/mode/markdown");
        editor.getSession().on('change', function(e) {
          console.log(e);
        });

        (function($) {
          "use strict";
          $(function() {
            $(".submit-post").on("click", function () {
              console.log();
              return false;
            });
          });
        }(jQuery));
      </script>

      <!-- jquery file uploader -->
      <script src="/static/components/blueimp-file-upload/js/vendor/jquery.ui.widget.js"></script>
      <script src="/static/components/blueimp-file-upload/js/jquery.iframe-transport.js"></script>
      <script src="/static/components/blueimp-file-upload/js/jquery.fileupload.js"></script>
      <script>
        $(function () {
          $('#fileupload').fileupload({
            url: '/uploader',
            dataType: 'json',
            done: function (e, data) {
              console.dir(data);
              $(".img-view img").attr('src', data.result.url);
            }
          });
        });
      </script>

      <div class="img-view">
        <img src="">
      </div>
    </div><!-- #content .site-content -->
  </div><!-- #primary .content-area -->
</div><!-- / container-->
{% endblock %}
